<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Gearpump Performance Report - GEARPUMP 0.6.2-SNAPSHOT Documentation</title>
        
          <meta name="description" content="Gearpump Performance Report">
        
        

        

        <link rel="stylesheet" href="./css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="./css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="./css/main.css">

        <script src="./js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="./css/pygments-default.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <div class="navbar navbar-fixed-top" id="topbar">
            <div class="navbar-inner">
                <div class="container">
                    <div class="brand"><a href="./index.html">
                      <img alt="logo" src="./img/logo2.png" style="height:48px;"/></a>
                    </div>
                    <ul class="nav">
                        <li><a href="./overview.html">Overview</a></li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Introduction<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="./features.html">Technical Highlights</a></li>
                                <li><a href="./usecases.html">Use Cases</a></li>
                                <li><a href="./performance-report.html">Performance</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="./../releases/0.6.2-SNAPSHOT/index.html">Latest Release (0.6.2-SNAPSHOT)</a></li>
                                <li><a href="./roadmap.html">Roadmap</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="https://groups.google.com/forum/#!forum/gearpump-user">Mailing List</a></li>
                                <li><a href="https://github.com/gearpump/gearpump/issues">Issue Tracker</a></li>
                                <li><a href="./how-to-contribute.html">How to Contribute</a></li>
                                <li><a href="./coding-style.html">Coding Style</a></li>
                                <li class="divider"></li>
                                <li><a href="./faq.html">FAQ</a><li>
                                <li><a href="./about.html">About</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Publication<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                              <li><a href="blogs.html">Blog</a></li>
                              <li><a href="./publications.html">Publications</a></li>
                            </ul>
                        </li>

                        <li><a href="./download.html">Download</a></li>

                    </ul>
                    <!--<p class="navbar-text pull-right"><span class="version-text">v</span></p>-->
                </div>
            </div>
        </div>

        <div class="container" id="content">
          
            <h1 class="title">Gearpump Performance Report</h1>
          

          <h1 id="performance-evaluation">Performance Evaluation</h1>

<p>To illustrate the performance of Gearpump, we mainly focused on two aspects, throughput and latency, using a micro benchmark called SOL (an example in the Gearpump package) whose topology is quite simple. SOLStreamProducer delivers messages to SOLStreamProcessor constantly and SOLStreamProcessor does nothing. We set up a 4-nodes cluster with 10GbE network and each node&#8217;s hardware is briefly shown as follows:</p>

<p>Processor: 32 core Intel(R) Xeon(R) CPU E5-2680 2.70GHz<br />
Memory: 128GB</p>

<h2 id="throughput">Throughput</h2>

<p>Gearpump uses Graphite for the metrics dashboard. We tried to explore the upper bound of the throughput, after launching 64 SOLStreamProducer and 64 SOLStreamProcessor the Figure below shows that the whole throughput of the cluster can reach about 13 million messages/second(100 bytes per message)</p>

<p>Figure: Performance Evaluation, Throughput and Latency</p>

<h2 id="latency">Latency</h2>

<p>When we transfer message at the max throughput above, the average latency between two tasks is 17ms, standard deviation is 13ms.</p>

<p>Figure: Latency between Two tasks(ms)</p>

<h2 id="fault-recovery-time">Fault Recovery time</h2>

<p>When the corruption is detected, for example the Executor is down, Gearpump will reallocate the resource and restart the application. It takes about 10 seconds to recover the application.</p>

<h2 id="how-to-setup-the-benchmark-environment">How to setup the benchmark environment?</h2>

<h3 id="prepare-the-env">Prepare the env</h3>

<p>1). Set up a node running Graphite, see guide doc/dashboard/README.md.</p>

<p>2). Set up a 4-nodes Gearpump cluster with 10GbE network which have 3 Workers on each node. In our test environment, each node has 128GB memory and Intel? Xeon? 32-core processor E5-2680 2.70GHz. Make sure the metrics is enabled in Gearpump.</p>

<p>3). Submit a SOL application with 32 SteamProducers and 32 StreamProcessors:</p>

<pre><code class="language-bash">bin/gear app -jar ./examples/sol/target/pack/lib/gearpump-examples-$VERSION.jar io.gearpump.streaming.examples.sol.SOL -streamProducer 32 -streamProcessor 32 -runseconds 600
</code></pre>

<p>4). Browser http://$HOST:801/, you should see a Grafana dashboard. The HOST should be the node runs Graphite.</p>

<p>5). Copy the config file doc/dashboard/graphana_dashboard, and modify the <code>host</code> filed to the actual hosts which runs Gearpump and the <code>source</code> and <code>target</code> fields. Please note that the format of the value should exactly the same as existing format and you also need to manually add the rest task ID to the value of <code>All</code> under <code>source</code> and <code>target</code> filed since now the number of each task type is 32.</p>

<p>6). In the Grafana web page, click the &#8220;search&#8221; button and then import the config file mentioned above.</p>

<h3 id="metrics">Metrics</h3>

<p>We use codahale metrics library. Gearpump support to use Graphite to visualize the metrics data. Metrics is disabled by default. To use it, you need to configure the &#8216;conf/gear.conf&#8217;</p>

<pre><code class="language-bash">  gearpump.metrics.reporter = graphite
  gearpump.metrics.enabled = true         ## Default is false, thus metrics is not enabled.
  gearpump.metrics.graphite.host = "your actual graphite host name or ip"  
  gearpump.metrics.graphite.port = 2003   ## Your graphite port
  gearpump.metrics.sample.rate = 10       ## this means we will sample 1 message for every 10 messages
</code></pre>

<p>For guide about how to install and configure Graphite, please check the Graphite website http://graphite.wikidot.com/.  For guide about how to use Grafana, please check guide in <a href="https://github.com/gearpump/gearpump/blob/master/doc/dashboard/README.md">doc/dashboard/readme.md</a></p>

<p>Here is how it looks like for grafana dashboard:</p>

<p><img src="img/dashboard.png" alt="Dashboard" /></p>


        </div> <!-- /container -->

        <script src="./js/vendor/jquery-2.1.4.min.js"></script>
        <script src="./js/vendor/bootstrap-3.3.5.min.js"></script>
        <script src="./js/vendor/anchor-1.1.1.min.js"></script>
        <script src="./js/main.js"></script>

        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    </body>
</html>
